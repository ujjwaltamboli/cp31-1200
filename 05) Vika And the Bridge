#include <bits/stdc++.h>
using namespace std;
int main(){
    long long t;
    cin>>t;
    while (t--){
        long long n,k;
        cin>>n>>k;
        vector<long long> store(n,0);
        for (long long i=0;i<n;i++){
            cin>>store[i];
        }

        vector<long long> prevPlank(k+1,-1);
        vector<long long> maxi(k+1,0);
        vector<long long> secondMaxi(k+1,0);
        for (long long i=0;i<n;i++){ //O(n)
            if ((i-prevPlank[store[i]]-1)>=maxi[store[i]]){
                secondMaxi[store[i]]=maxi[store[i]];
                maxi[store[i]]=i-prevPlank[store[i]]-1;
            }
            else if ((i-prevPlank[store[i]]-1)<maxi[store[i]] && (i-prevPlank[store[i]]-1)>secondMaxi[store[i]]){
                secondMaxi[store[i]]=i-prevPlank[store[i]]-1;
            }
            prevPlank[store[i]]=i;
        }

        for (long long i=1;i<=k;i++){//O(k)
            if ((n-prevPlank[i]-1)>=maxi[i]){
                secondMaxi[i]=maxi[i];
                maxi[i]=n-prevPlank[i]-1;
            }
            else if ((n-prevPlank[i]-1)<maxi[i] && (n-prevPlank[i]-1)>=secondMaxi[i]){
                secondMaxi[i]=n-prevPlank[i]-1;
            }
            prevPlank[i]=n;
        }

        for (int i=1;i<=k;i++){//O(k)
            maxi[i]=max(maxi[i]/2,secondMaxi[i]);
        }

        long long mini=LLONG_MAX;
        for (long long i=1;i<=k;i++){
            mini=min(mini, maxi[i]);
        }

        cout<<mini<<endl;

        //T.C.:- O(n+k);
        //S.C.:- O(n+k);

    }
    return 0;
}
